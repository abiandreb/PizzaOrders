<div class="bg-white">
  <div class="mx-auto max-w-2xl px-4 pt-16 pb-24 sm:px-6 lg:max-w-7xl lg:px-8">
    <h1 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">Checkout</h1>
    <div class="mt-12 lg:grid lg:grid-cols-12 lg:items-start lg:gap-x-12 xl:gap-x-16">
      <section aria-labelledby="contact-info-heading" class="lg:col-span-7">
        <h2 id="contact-info-heading" class="text-lg font-medium text-gray-900">
          @if (authService.isLoggedIn()) {
            Shipping Information
          } @else {
            Contact and Shipping Information
          }
        </h2>

        <form [formGroup]="checkoutForm" (ngSubmit)="placeOrder()" class="mt-6">
          <div class="grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-4">
            <div>
              <label for="name" class="block text-sm font-medium text-gray-700">Name</label>
              <div class="mt-1">
                <input type="text" id="name" formControlName="name" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm bg-white text-gray-900">
              </div>
            </div>

            <div>
              <label for="email" class="block text-sm font-medium text-gray-700">Email address</label>
              <div class="mt-1">
                <input type="email" id="email" formControlName="email" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm bg-white text-gray-900">
              </div>
            </div>

            <div class="sm:col-span-2">
              <label for="phone" class="block text-sm font-medium text-gray-700">Phone</label>
              <div class="mt-1">
                <input type="text" id="phone" formControlName="phone" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm bg-white text-gray-900">
              </div>
            </div>

            <div class="sm:col-span-2">
              <label for="address" class="block text-sm font-medium text-gray-700">Address</label>
              <div class="mt-1">
                <input type="text" id="address" formControlName="address" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-orange-500 focus:ring-orange-500 sm:text-sm bg-white text-gray-900">
              </div>
            </div>
          </div>
        </form>
      </section>

      <!-- Order summary -->
      <section aria-labelledby="order-summary-heading" class="mt-16 rounded-lg bg-gray-50 px-4 py-6 sm:p-6 lg:col-span-5 lg:mt-0 lg:p-8">
        <h2 id="order-summary-heading" class="text-lg font-medium text-gray-900">Order summary</h2>

        <dl class="mt-6 space-y-4">
            @for(item of cartService.cartItems(); track item.product.id) {
                <div class="flex items-center justify-between">
                    <dt class="text-sm text-gray-600">{{item.quantity}}x {{item.product.name}}</dt>
                    <dd class="text-sm font-medium text-gray-900">{{item.product.price * item.quantity | currency}}</dd>
                </div>
            }
          <div class="flex items-center justify-between border-t border-gray-200 pt-4">
            <dt class="flex items-center text-sm text-gray-600">
              <span>Subtotal</span>
            </dt>
            <dd class="text-sm font-medium text-gray-900">{{ cartService.subtotal() | currency }}</dd>
          </div>
          <div class="flex items-center justify-between">
            <dt class="flex text-sm text-gray-600">
              <span>Tax</span>
            </dt>
            <dd class="text-sm font-medium text-gray-900">{{ cartService.tax() | currency }}</dd>
          </div>
          <div class="flex items-center justify-between border-t border-gray-200 pt-4">
            <dt class="text-base font-medium text-gray-900">Order total</dt>
            <dd class="text-base font-medium text-gray-900">{{ cartService.total() | currency }}</dd>
          </div>
        </dl>

        <div class="mt-6">
          <button (click)="placeOrder()" [disabled]="isProcessing()" type="submit" class="w-full rounded-md border border-transparent bg-orange-600 py-3 px-4 text-base font-medium text-white shadow-sm hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 focus:ring-offset-gray-50 disabled:opacity-50">
            @if (isProcessing()) {
              <span>Processing...</span>
            } @else {
              <span>Place Order</span>
            }
          </button>
        </div>
      </section>
    </div>
  </div>
</div>